# AI駆動開発フレームワーク セットアップログ

**日付:** 2025年7月30日
**ブランチ:** `feature/setup-ai-context-framework`

## 目的

AI（Gemini）がプロジェクトのコンテキスト（目的、技術ルール、作業状況）をセッション間で効率的に引き継ぎ、自律的かつ一貫性のある開発を実現するための情報アーキテクチャを設計・構築する。

## 議論と意思決定の過程

### 1. 初期アーキテクチャの設計 (2025/07/30)

-   **概要:** `GEMINI/`ディレクトリを導入し、憲法・技術ガイド・作業ログの3つのコアファイルでAIのコンテキストを管理する初期案をAIが提示。人間からのフィードバック（手動変更の許容、ログの分割、仕様書の配置など）を受け、対話を通じてアーキテクチャを洗練させた。
-   **結果:** `GEMINI/`配下に憲法と技術ガイドを、ログは`GEMINI/logs/`に分離、仕様書は`games/[slug]/`に残す形で合意。

### 2. 既存ドキュメントの統合 (2025/07/30)

-   **概要:** `project-docs/`配下の既存ドキュメントの内容を、新しく作成した`GEMINI/`配下のファイル群に統合し、古いドキュメントは削除。情報ソースの一元化を達成した。

### 3. 最終ワークフローの確立 (2025/07/30)

-   **課題:** トークン効率、運用の簡素化、人間とAIの役割分担の明確化。
-   **解決策:**
    1.  **動的コンテキストファイルの導入:** `GEMINI/3_SESSION_CONTEXT.md`を唯一の「エントリーポイント」とし、AIはここから必要な情報を再帰的に参照する。トークン消費を最小限に抑える。
    2.  **コンテキストのブランチ連動:** `3_SESSION_CONTEXT.md`をバージョン管理対象とし、ブランチと共にコンテキストが自動で切り替わる仕組みを導入。並行作業を可能にする。
    3.  **コンテキスト・リセット:** 新規タスク開始時に、AIは`3_SESSION_CONTEXT.md`のタスク情報をリセットし、コンテキスト汚染を防ぐ。
    4.  **人間向けガイドの作成:** 人間が守るべきルール（セッション開始方法など）を`GEMINI/HUMAN_GUIDE.md`に明記する。
    5.  **AIの責務拡大:** ブランチ作成、コミット、プッシュの主導権をAIに委ね、人間は承認に徹する。このルールを`2_TECHNICAL_GUIDE.md`に追記する。

### 4. 最終アーキテクチャのリファクタリング (2025/07/30)

-   **課題:** `GEMINI/`ディレクトリ内のファイル命名規則の不統一、`GEMINI/`と`project-docs/`の責務の曖昧さ、`prompt_template.txt`の独立性。
-   **解決策:**
    1.  **`GEMINI/`の純化:** AIが直接利用する「ワーキングメモリ」に特化させ、ファイルは`1_`, `2_`, `3_`の番号で処理順序と重要度を示す。
    2.  **`project-docs/`の新設:** 人間が主に参照する運用ドキュメント（`HUMAN_GUIDE.md`）やプロジェクトの歴史的記録（`SETUP_LOG.md`）を格納する。
    3.  **`prompt_template.txt`の廃止:** その内容を`project-docs/HUMAN_GUIDE.md`内にコードスニペットとして統合し、人間向けの指示を一元化。
    4.  **`docs`名称の回避:** Next.jsとの競合を避けるため、`project-docs`を継続使用。
    5.  **`GEMINI/`ファイル番号の調整:** 人間にとってのルールの強さ（憲法 > 掟 > 動的コンテキスト）を反映した番号付け（`1_`, `2_`, `3_`）に変更。AIの処理には影響しないことを確認。
    6.  **ゲーム仕様書の配置再確認:** `manifest.json`などのゲーム仕様は、ゲームの実装の一部であり、コードから参照されるデータであるため、`games/[slug]/`配下に留めることを再確認。

-   **最終的なアーキテクチャ:**

    ```
    /
    ├── GEMINI/  (AIのワーキングメモリ)
    │   ├── 1_PROJECT_MANIFEST.md  (憲法)
    │   ├── 2_TECHNICAL_GUIDE.md   (掟)
    │   └── 3_SESSION_CONTEXT.md   (動的コンテキスト)
    │
    ├── project-docs/ (人間向けの運用ドキュメントと記録)
    │   ├── HUMAN_GUIDE.md       (promptテンプレートを内包)
    │   └── SETUP_LOG.md
    │
    └── games/
        └── [slug]/
            ├── manifest.json      (ゲーム仕様: 実装の一部)
            └── ...                (ゲームのコード)
    ```