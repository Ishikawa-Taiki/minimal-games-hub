# 動作仕様書: 神経衰弱

本ドキュメントは「神経衰弱」ゲームの動作仕様を定義します。

## 1. 難易度の選択

-   **トリガー:** プレイヤーが難易度セレクターのラジオボタンをクリックした時。
-   **前提条件:** ゲームが開始されていないこと（1枚もカードがめくられていない状態）。
-   **アクション:**
    1.  選択された難易度（かんたん、ふつう、むずかしい）を新しい難易度として設定します。
    2.  新しい難易度設定に基づいて、ゲームを初期化します（下記「2. ゲームの初期化」を参照）。

## 2. ゲームの初期化

-   **トリガー:** ページが読み込まれた時、難易度が変更された時、または「ゲームをリセット」ボタンがクリックされた時。
-   **アクション:**
    1.  現在設定されている難易度に基づいて、適切な枚数のカード（20, 40, または54枚）からなるデッキを生成します。
    2.  デッキをランダムにシャッフルします。
    3.  全てのカードを裏向きの状態でゲームボードに配置します。
    4.  プレイヤー1とプレイヤー2のスコアを0に初期化します。
    5.  現在のアクティブプレイヤーをプレイヤー1に設定します。

## 3. カードのクリック

-   **トリガー:** プレイヤーが裏向きのカードを1枚クリックした時。
-   **前提条件:**
    -   クリックされたカードがすでにマッチ済み、または表向きでないこと。
    -   現在、2枚のカードが表向きになって評価待ちの状態で無いこと。
-   **アクション:**
    1.  クリックされたカードを表向きにします。
    2.  表向きになっているカードの枚数を記録します。

### 3.1. 2枚目のカードをめくった時の動作

-   **トリガー:** プレイヤーが2枚目のカードをクリックし、表向きのカードが合計2枚になった時。
-   **アクション（マッチした場合）:**
    1.  2枚のカードの数字が一致した場合、現在のプレイヤーのスコアを1増やします。
    2.  2枚のカードを「マッチ済み」状態に変更します。
    3.  プレイヤーのターンは交代せず、同じプレイヤーが続けてカードをめくることができます。
    4.  全てのカードがマッチ済みになった場合、ゲームを終了し、勝敗を決定します。
-   **アクション（マッチしなかった場合）:**
    1.  2枚のカードの数字が一致しなかった場合、カードを1.2秒間だけ表向きで表示します。
    2.  1.2秒後、2枚のカードを再び裏向きに戻します。
    3.  次のプレイヤーにターンを交代します。

## 4. リセットボタンのクリック

-   **トリガー:** 「ゲームをリセット」ボタンがクリックされた時。
-   **アクション:**
    -   現在の難易度設定を維持したまま、ゲームの状態を初期状態に戻します（上記「2. ゲームの初期化」を参照）。
