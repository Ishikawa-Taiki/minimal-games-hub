# リバーシ システム動作仕様

## 1. ゲームの状態管理
システムは、以下の情報を常に記憶します。
- 8x8の盤面の各マスが「黒の石」「白の石」「空」のいずれであるか。
- 現在の手番は黒か白か。
- 黒と白、それぞれの現在の石の数。
- ゲームの進行状況（プレイ中、パス発生、決着）。
- 現在の手番のプレイヤーが石を置けるすべてのマスと、その場合にひっくり返せる相手の石の情報のリスト。
- ヒントの表示レベル（ヒントなし、おけるばしょ、ぜんぶヒント）。

## 2. ゲームの初期化
ゲーム開始時、システムは以下の状態になります。
- 盤面の中央4マスに、黒と白の石を2つずつ交互に配置します。
- 他のマスはすべて「空」の状態です。
- 最初の手番は黒です。
- スコアは黒2点、白2点です。
- ゲームはプレイ中の状態です。
- ヒントの表示レベルは「ヒントなし」です。

## 3. プレイヤーの操作と状態遷移
プレイヤーが盤面のいずれかのマスを選択すると、システムは以下の処理を行います。
1.  選択されたマスが、現在の手番のプレイヤーが石を置ける有効なマスであることを確認します。
2.  条件を満たす場合、そのマスに現在の手番のプレイヤーの石を配置します。
3.  ルールに従い、挟まれた相手の石をすべて自分の色の石にひっくり返します。
4.  盤面の状態を評価し、黒と白のスコアを更新します。
5.  手番を相手プレイヤーに交代します。
6.  交代後、新しい手番のプレイヤーが石を置ける有効なマスがあるか計算します。

## 4. ゲームの進行ルール
- **パス:**
    - 手番が移ったプレイヤーに、石を置ける有効なマスが一つもない場合、手番は自動的に元のプレイヤーに戻ります（パスとなります）。
- **ゲーム終了:**
    - 盤面のすべてのマスが石で埋まった場合、ゲームは終了します。
    - 両プレイヤーともに、石を置ける有効なマスがなくなった場合、ゲームは終了します。
- **勝敗決定:**
    - ゲーム終了時に、より多くの石を持っているプレイヤーを勝者とします。同数の場合は引き分けです。

## 5. ヒント機能の操作
プレイヤーが「おしえて！」ボタンを押すたびに、ヒントの表示レベルが以下の順で切り替わります。
- 「ヒントなし」→「おけるばしょ」
- 「おけるばしょ」→「ぜんぶヒント」
- 「ぜんぶヒント」→「ヒントなし」

## 6. 不正な操作への対応
- プレイヤーが石を置けないマスを選択した場合、システムはその操作を無視し、ゲームの状態は一切変化しません。
- 駒がひっくり返るアニメーションの再生中は、プレイヤーは盤面への新たな操作を行うことはできません。システムは、この間の操作をすべて無視します。

## 7. ゲームの再初期化
プレイヤーが「はじめからやりなおす」ボタンを押した場合、システムはゲームの状態を「2. ゲームの初期化」で定義された状態にリセットします。ヒントの表示レベルも「ヒントなし」にリセットされます。
