# 技術ガイド (TECHNICAL GUIDE)

本ドキュメントは、プロジェクトの技術的なルールと規約を定義します。AIは常にこれらのガイドラインを遵守しなければなりません。

## 1. 環境構築

### Node.jsバージョン管理
本プロジェクトでは、Node.jsのバージョン管理に`nodenv`を使用しています。`.node-version`ファイルに指定されたバージョンを使用してください。

```bash
# プロジェクトで使用するNode.jsバージョンをインストール
nodenv install

# プロジェクトディレクトリでバージョンを有効化
nodenv local
```

### 依存関係のインストール
プロジェクトのルートディレクトリで、以下のコマンドを実行して依存関係をインストールします。

```bash
npm install
```

## 2. 開発サイクル

### 開発サーバーの起動
以下のコマンドを実行すると、開発サーバーが起動し、ブラウザでアプリケーションを確認できます。

```bash
npm run dev
```

### ビルド
本プロジェクトは静的サイトとしてエクスポートされます。以下のコマンドでビルドを実行できます。

```bash
npm run build
```

## 3. 技術スタック
-   **フレームワーク:** Next.js
-   **言語:** TypeScript
-   **スタイリング:** Tailwind CSS (`globals.css` と PostCSS経由)
-   **Node.jsバージョン管理:** `nodenv` (`.node-version` ファイルを参照)

## 4. コーディング規約
-   **リンティング & フォーマット:** `eslint.config.mjs` に定義されたルールに準拠します。
-   **型安全性:** すべてのコードはTypeScriptを用いて厳密に型付けされるべきです。

## 5. GitワークフローとAIの責務

-   **ブランチ:** 新規タスクの開始時、AIは人間の指示に基づき、適切な名前でフィーチャーブランチを作成する。
-   **コミット:** 作業の区切りで、AIは変更内容を要約したコミットメッセージ（日本語）を作成し、人間の承認を得てコミットを実行する。
-   **プッシュ:** AIは人間の指示に基づき、現在のブランチをリモートにプッシュする。
-   **言語:** コミットメッセージ、および本プロジェクトで作成されるすべてのドキュメント（仕様書、README、ログ等）は、原則として日本語で記述します。
-   **マージ:** 変更はPull Requestを経由して `main` ブランチにマージされます。

## 6. セッション管理ワークフロー

本プロジェクトは `docs/ai-workflow/3-session-context.md` を単一エントリーポイントとする。AIは以下の責務を負う。

1.  **コンテキストの参照:** セッション開始時、AIはまず`docs/ai-workflow/3-session-context.md`を読み込み、現状を把握する。詳細情報が必要な場合は、そこからポインタをたどって各ドキュメントを参照する。
2.  **コンテキストのリセット:** 人間から新しいタスクの指示を受けた場合、AIは`docs/ai-workflow/3-session-context.md`の「現在のタスク」セクションを新しい内容でリセットする。
3.  **コンテキストの更新:** セッション終了時、AIは次のセッションのために、`docs/ai-workflow/3-session-context.md`を最新の作業状況（ブランチ、タスクの進捗など）で更新し、コミットに含める。

## 7. ビルド & デプロイ
-   **デプロイ:** `main` ブランチへのマージごとに、`.github/workflows/deploy.yml` ワークフローによってGitHub Pagesへ自動的にデプロイされます。
-   **GitHub Pages設定:** デプロイが正しく機能するためには、リポジトリの `Settings > Pages` で、`Build and deployment` の `Source` が `GitHub Actions` に設定されている必要があります。

## 8. 仕様参照ルール
-   **ルール:** ゲームの実装や修正を開始する前に、AIは必ず対象ゲームのディレクトリ（`games/[slug]/`）に定義された仕様を最初に読み込み、完全に理解しなければなりません。これには `manifest.json` や `README.md` などが含まれますが、これに限定されません。AIはこれらの仕様に基づいて作業を行う必要があります。

## 9. ドキュメントの鮮度維持

プロジェクトの「顔」として、`README.md`は常に最新の状態を保つ必要があります。以下の様な、プロジェクトの全体像に影響を与える変更を行う際には、AIは`README.md`の更新が必要かどうかを必ず検討し、必要であれば変更を提案しなければなりません。

-   新しいゲームの追加
-   開発手順やビルド方法の変更
-   デプロイ先URLの変更
-   プロジェクトのコンセプトに関わる大きな変更

## 10. AIのドキュメント管理責務

AIは、プロジェクトのドキュメント全体を常に最新かつ整合性の取れた状態に保つ責務を負う。具体的には以下の行動を自律的に実行する。

1.  **議論と意思決定の記録:** 人間との対話を通じて、重要な議論や意思決定が行われた場合、その内容、背景、結果を`docs/project-info/setup-log.md`に詳細に記録する。
2.  **関連ドキュメントの特定と更新:** 議論や意思決定が、`docs/ai-workflow/`配下の憲法や技術ガイド、`docs/project-info/`配下の人間向けガイド、あるいは`README.md`など、他のドキュメントに影響を与える場合、AIは自律的にその影響範囲を特定し、関連するすべてのドキュメントを適切に更新する。
3.  **プロアクティブな提案:** ドキュメントの更新が必要であると判断した場合、人間の明示的な指示を待たずに、更新内容を提案し、承認を得て実行する。
