# AI駆動開発フレームワーク セットアップログ

**日付:** 2025年7月30日
**ブランチ:** `feature/setup-ai-context-framework`

## 目的

AI（Gemini）がプロジェクトのコンテキスト（目的、技術ルール、作業状況）をセッション間で効率的に引き継ぎ、自律的かつ一貫性のある開発を実現するための情報アーキテクチャを設計・構築する。

## 議論と意思決定の過程

### 1. 初期アーキテクチャの設計 (2025/07/30)

-   **概要:** `GEMINI/`ディレクトリを導入し、憲法・技術ガイド・作業ログの3つのコアファイルでAIのコンテキストを管理する初期案をAIが提示。人間からのフィードバック（手動変更の許容、ログの分割、仕様書の配置など）を受け、対話を通じてアーキテクチャを洗練させた。
-   **結果:** `GEMINI/`配下に憲法と技術ガイドを、ログは`GEMINI/logs/`に分離、仕様書は`games/[slug]/`に残す形で合意。

### 2. 既存ドキュメントの統合 (2025/07/30)

-   **概要:** `project-docs/`配下の既存ドキュメントの内容を、新しく作成した`GEMINI/`配下のファイル群に統合し、古いドキュメントは削除。情報ソースの一元化を達成した。

### 3. 最終ワークフローの確立 (2025/07/30)

-   **課題:** トークン効率、運用の簡素化、人間とAIの役割分担の明確化。
-   **解決策:**
    1.  **動的コンテキストファイルの導入:** `docs/ai-workflow/3-session-context.md`を唯一の「エントリーポイント」とし、AIはここから必要な情報を再帰的に参照する。トークン消費を最小限に抑える。
    2.  **コンテキストのブランチ連動:** `docs/ai-workflow/3-session-context.md`をバージョン管理対象とし、ブランチと共にコンテキストが自動で切り替わる仕組みを導入。並行作業を可能にする。
    3.  **コンテキスト・リセット:** 新規タスク開始時に、AIは`docs/ai-workflow/3-session-context.md`のタスク情報をリセットし、コンテキスト汚染を防ぐ。
    4.  **人間向けガイドの作成:** 人間が守るべきルール（セッション開始方法など）を`docs/project-info/human-guide.md`に明記する。
    5.  **AIの責務拡大:** ブランチ作成、コミット、プッシュの主導権をAIに委ね、人間は承認に徹する。このルールを`docs/ai-workflow/2-technical-guide.md`に追記する。

### 4. 最終アーキテクチャのリファクタリング (2025/07/30)

-   **課題:** `GEMINI/`ディレクトリ内のファイル命名規則の不統一、`GEMINI/`と`project-docs/`の責務の曖昧さ、`prompt_template.txt`の独立性。
-   **解決策:**
    1.  **`docs/`ディレクトリの新設:** ドキュメントのルートディレクトリとして`docs/`を新設。`index.md`をエントリーポイントとする。
    2.  **`ai-workflow/`と`project-info/`への分割:** `docs/`配下を、AIが直接利用する`ai-workflow/`と、人間向けの運用情報`project-info/`に分割。
    3.  **命名規則の統一:** すべてのディレクトリ名、ファイル名を小文字・ハイフン区切りに統一。
    4.  **`GEMINI/`の純化:** `docs/ai-workflow/`に移動したAI関連ファイルは、`1-`, `2-`, `3-`の番号で処理順序と重要度を示す。
    5.  **`prompt_template.txt`の廃止:** その内容を`docs/project-info/human-guide.md`内にコードスニペットとして統合。
    6.  **`docs`名称の採用:** Next.jsとの競合の可能性を認識しつつも、一般的な慣習として`docs`を採用。問題発生時は再検討。
    7.  **ゲーム仕様書の配置再確認:** `manifest.json`などのゲーム仕様は、ゲームの実装の一部であり、コードから参照されるデータであるため、`games/[slug]/`配下に留めることを再確認。

-   **最終的なアーキテクチャ:**

    '''
    /
    ├── docs/
    │   ├── index.md                 (ドキュメントのエントリーポイント/目次)
    │   │
    │   ├── ai-workflow/             (AIが直接利用する情報)
    │   │   ├── 1-project-manifest.md  (プロジェクト憲法)
    │   │   ├── 2-technical-guide.md   (技術ガイド)
    │   │   ├── 3-session-context.md   (動的セッションコンテキスト)
    │   │   └── logs/                  (AI生成ログ)
    │   │       ├── system.log
    │   │       └── games/
    │   │           └── [slug].log
    │   │
    │   └── project-info/            (人間向けの運用情報とプロジェクト記録)
    │       ├── human-guide.md         (promptテンプレートを内包)
    │       └── setup-log.md           (セットアップログ/議事録)
    │
    └── games/
        └── [slug]/
            ├── manifest.json          (ゲーム仕様: 実装の一部)
            └── ...                    (ゲームのコード)
    '''

### 5. `SETUP_LOG.md`の自律的更新に関する議論 (2025/07/30)

-   **課題:** AIが`SETUP_LOG.md`を自発的に、かつ正確に更新できていない。人間からの繰り返しのご指摘により、この問題が顕在化した。
-   **解決策:**
    1.  **責務の明確化:** `docs/ai-workflow/2-technical-guide.md`に「AIのログ管理責務」に関する明確なルールを追加する。
    2.  **プロアクティブな行動:** AIは、議論の過程や意思決定の背景など、`SETUP_LOG.md`に記録すべき内容が発生した際に、自律的にその内容を追記する。
    3.  **本議論の記録:** この`SETUP_LOG.md`の更新に関する議論自体を、ここに記録する。

### 6. ドキュメントのプロアクティブな更新に関する議論 (2025/07/30)

-   **課題:** AIが特定のドキュメント（例: `SETUP_LOG.md`）の更新に限定され、議論の文脈から関連する他のドキュメントへの影響を自律的に判断し、更新できていない。
-   **解決策:**
    1.  **包括的な責務の追加:** `docs/ai-workflow/2-technical-guide.md`に「AIのドキュメント管理責務」として、議論や意思決定がどのドキュメントに影響を与えるかを自律的に判断し、関連するすべてのドキュメントをプロアクティブに更新するルールを追加する。
    2.  **本議論の記録:** この`docs/project-info/setup-log.md`の更新に関する議論自体を、ここに記録する。

---

**日付:** 2025年7月31日
**ブランチ:** `fix/tictactoe-link`, `docs/organize-markdown`

## 目的

GitHub Pagesで発生したリンク切れ問題の修正と、それに伴うプロジェクト全体のドキュメントルールの見直しと整理。

## 議論と意思決定の過程

### 1. GitHub Pagesのパス問題修正
- **課題:** GitHub Pagesデプロイ時に、リポジトリ名がパスに含まれないためリンクが機能しない。
- **解決策:** `next.config.ts`に`basePath`と`assetPrefix`を設定。ローカル開発に影響が出ないよう、`process.env.NODE_ENV`を利用して本番ビルド時のみ有効になるようにした。

### 2. AI協業ワークフローの明確化
- **課題:** AIの責務と人間の責務の境界が曖昧で、AIによるドキュメントの自律的更新が機能していなかった。
- **解決策:** `technical-guide.md`に「ドキュメントの所有権と更新責務」を定義。各ドキュメントの責任分界点を明確にした。

### 3. ドキュメントの全体精査と再編成
- **課題:** ドキュメント間に矛盾（`README.md`と`technical-guide.md`の開発手順）や不整合（`human-guide.md`のPR手順の欠如）が存在。また、ログが適切に記録されていなかった。
- **解決策:** 全体精査を実施し、矛盾点を修正。ログの役割を「議事録」と「作業ログ」に再定義し、それぞれの責務をルール化した。
