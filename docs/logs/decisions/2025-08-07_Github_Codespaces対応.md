**日付:** 2025年8月7日

## 目的

プロジェクトをGithub Codespaces上で開発可能にし、スマートフォン等の別デバイスからのアクセスを容易にすることで、開発の柔軟性を向上させる。

## 議論と意思決定の過程

### 1. Codespaces環境の定義
- **課題:** 新しい開発者が環境をセットアップする際の手間を削減し、誰でも同じ開発環境を即座に利用できるようにしたい。
- **解決策:** `.devcontainer/devcontainer.json` を導入。コンテナ起動時に `npm install` が自動で実行されるように設定し、手動でのセットアップ作業を不要にした。
- **議論:** 当初、Codespacesのデフォルトイメージに含まれる `git-lfs` のセットアップスクリプトと、プロジェクトの `husky` の pre-push フックが競合し、ビルドに失敗。`git-lfs` を含まない、より基本的なNode.jsイメージ (`mcr.microsoft.com/devcontainers/javascript-node:1-20-bullseye`) に変更することで問題を解決した。

### 2. 開発サーバーの外部アクセス対応
- **課題:** デフォルトの `next dev` コマンドは `localhost` でサーバーを起動するため、Codespaces環境外のデバイス（スマートフォンなど）からアクセスできない。
- **解決策:** `package.json` の `dev` スクリプトを `next dev -H 0.0.0.0` に変更。これにより、コンテナのすべてのネットワークインターフェースで待受状態となり、ポートフォワーディング経経由での外部アクセスが可能になった。
- **セキュリティ:** Codespacesのポートフォワーディングはデフォルトでプライベート（認証されたユーザーのみアクセス可能）であるため、セキュリティ上のリスクは低いと判断。

### 3. Gemini CLIの導入方法
- **課題:** Codespaces環境でGemini CLIを利用可能にする必要がある。
- **議論:** 
    - **初期案:** `npm install -g @google/gemini-cli` を `postCreateCommand` に追加する案が挙がった。
    - **問題点:** グローバルインストールは、プロジェクトで管理されているNode.jsバージョンとの不整合や、依存関係の不明瞭化を招く可能性がある。
    - **最終決定:** `@google/gemini-cli` をプロジェクトの `devDependencies` として `package.json` に追加する方針を採択。これにより、`npm install` だけでCLIもインストールされ、`npm run gemini` (または `npx gemini`) でバージョン管理されたCLIを実行できるようになった。この方法は、環境の再現性と依存関係管理の観点から優れていると判断。