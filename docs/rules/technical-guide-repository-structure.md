# リポジトリ構造 (REPOSITORY STRUCTURE)

本ドキュメントは、プロジェクトのルートディレクトリに存在する主要なファイルやディレクトリの役割と目的を定義します。

プロジェクトの全体像を理解し、一貫した開発を行うためのガイドとして利用してください。

## 思想: 3層のレイヤー構造

本プロジェクトのソースコードは、`src`ディレクトリ内に以下の3層のレイヤー構造で管理されます。
これにより、関心事の分離と見通しの良い依存関係を維持します。

1.  **`src/core` (下層):**
    - **役割:** 汎用的なUIコンポーネント、共有フック、型定義、スタイルなど、プロジェクト全体で再利用可能な基幹部品を格納します。
    - **原則:** このレイヤーのコードは、他のどのレイヤー（`games`, `app`）にも依存してはなりません。完全に独立した自己完結型のモジュールとして設計されます。

2.  **`src/games` (中層):**
    - **役割:** 各ゲーム固有のロジック、UI、フックなどを格納します。
    - **原則:** `core`レイヤーの部品を利用して構築されますが、`app`レイヤーの存在を知ることはありません。

3.  **`src/app` (上層):**
    - **役割:** Next.jsのルーティング（App Router）、グローバルレイアウト、各ゲームページの提供など、アプリケーション全体のエンドポイントとUI統合を担当します。
    - **原則:** `games`レイヤーと`core`レイヤーの機能を利用して、最終的なWebアプリケーションを構築します。

### 依存関係のルール

**依存の方向は常に一方向（上層 → 中層 → 下層）でなければなりません。**

- **OK:** `app` → `games`, `app` → `core`, `games` → `core`
- **NG:** `core` → `games`, `core` → `app`, `games` → `app`

このルールを徹底することで、循環参照を防ぎ、コンポーネントやロジックの再利用性を高めます。

## 主要ディレクトリとファイル

### `src/`
- **目的:** アプリケーションの全てのソースコードを格納します。

### `src/app/`
- **目的:** Next.jsアプリケーションのUI統合とルーティングを担当する最上位レイヤー。
- **詳細:** App Routerに基づいたページ定義、グローバルレイアウト、各ゲームをWebページとして提供するためのコンポーネントが含まれます。`games`と`core`の機能を利用します。

### `src/games/`
- **目的:** 個別のゲーム実装を格納する中間レイヤー。
- **詳細:** 各ゲームはサブディレクトリ（例: `reversi/`）で管理されます。ゲーム固有のロジック、コンポーネント、スタイル、E2Eテストが含まれ、`core`の部品を利用して構築されます。E2Eテストは各ゲームディレクトリ内の`e2e`サブディレクトリに配置します。

### `src/core/`
- **目的:** プロジェクト全体で共有される基幹部品を格納する最下層レイヤー。
- **詳細:** 以下のサブディレクトリが含まれます。
    - **`components/`**: 汎用的なUIコンポーネント。
    - **`hooks/`**: 共有カスタムフック。
    - **`types/`**: 共有の型定義。
    - **`styles/`**: 共通スタイルシートなど。

### `.devcontainer/`
- **目的:** [GitHub Codespaces](https://github.co.jp/features/codespaces) 上での開発環境を定義します。
- **詳細:** このディレクトリには、Codespaces環境の構築に必要な設定ファイル（`devcontainer.json`など）が含まれています。新しい開発者が迅速に環境をセットアップできるようにするため、リポジトリで管理されます。

### `.kiro/`
- **目的:** AWS製のAI仕様駆動開発IDE（Kiro）に関連するファイルを格納します。
- **詳細:** Kiroを利用した開発で必要となる仕様書や設定ファイルがこのディレクトリに配置されます。

### `.husky/`
- **目的:** Gitフックを管理します。
- **詳細:** `pre-commit`や`pre-push`などのGitフックを[Husky](https://typicode.github.io/husky/)で管理しています。コミット前やプッシュ前にリンターやテストを自動実行し、コードの品質を維持します。

### `tests/`
- **目的:** 特定のゲームに依存しない、横断的なE2E（エンドツーエンド）テストに関連するファイルを格納します。
- **詳細:** [Playwright](https://playwright.dev/)を使用した、ナビゲーションや共通UIコンポーネントなど、複数のゲームやページにまたがるテストコードが配置されます。ゲーム固有のE2Eテストは、各ゲームのディレクトリ (`src/games/*/e2e/`) に配置します。ユニットテストやコンポーネントテストは、原則としてテスト対象と同じディレクトリに配置されます（例: `src/core/hooks/useResponsive.test.ts`）。

### `docs/`
- **目的:** プロジェクトに関連する全てのドキュメントを格納します。
- **詳細:** プロジェクトのルール、アーキテクチャ設計、意思決定の記録などが含まれます。

### `scripts/`
- **目的:** 開発ワークフローを補助するスクリプトを格納します。
- **詳細:** ライセンス情報の自動更新など、定型的なタスクを自動化します。
