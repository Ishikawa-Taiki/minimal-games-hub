# 技術ガイド - ゲーム仕様書アーキテクチャ

## 1. はじめに
本ドキュメントは、本プロジェクトにおける各ゲームの仕様を定義する、3つの主要なマークダウンファイル（`spec-rules.md`, `spec-action.md`, `spec-display.md`）の役割、責務、そしてそれらの間の関係性について説明します。

これらのドキュメントは、人間とAI開発者の両方がゲームの仕様を正確に理解し、一貫性のある開発を行うための基盤となります。

## 2. ドキュメントの三層構造
各ゲームの仕様は、以下の3つのドキュメントによって階層的に定義されます。

1.  **`spec-rules.md` (ルール仕様書)** - **最上位文書**
2.  **`spec-action.md` (システム動作仕様書)** - **中位文書**
3.  **`spec-display.md` (システム表示仕様書)** - **最下位文書**

これらのドキュメントは、`rules` -> `action` -> `display` の順で依存関係にあり、上位の文書は下位の文書に依存してはなりません。

---

### 2.1. `spec-rules.md`: ゲームの本質的なルール
- **目的:**
  - ゲームの根幹をなす、普遍的なルールのみを記述します。
  - このドキュメントは、仮にゲームをデジタルではなく、物理的なボードゲームとして遊ぶ場合でも成立するような、本質的なルールを定義することを目的とします。
- **責務:**
  - ゲームの目的、勝利条件、プレイヤーのアクション、禁止事項など、ゲームプレイそのものに関わるルールを網羅します。
- **禁止事項:**
  - システム、UI、実装に関するいかなる言及も行なってはなりません。例えば、「ボタンをクリックする」「スコアが画面に表示される」といった記述は含みません。

### 2.2. `spec-action.md`: システムとしての振る舞い
- **目的:**
  - `spec-rules.md`で定義されたゲームを、デジタルシステムとして実現するための、目に見えない内部的な動作、条件、状態遷移を定義します。
- **責務:**
  - ゲームの状態として何を管理・記憶すべきか（例：盤面の状態、現在のターン、スコア）。
  - ゲーム開始時に、システムがどのような状態になるべきか（初期化）。
  - プレイヤーの入力に対して、システムの状態がどのように変化するか（状態遷移）。
  - ルール上、自動的に発生する状態変化（例：パスの処理）。
  - 不正な操作に対するシステムの応答。
- **依存関係:**
  - この文書は `spec-rules.md` に記述されたルールを、システムがどのように解釈し、実行するかを定義します。したがって、`spec-rules.md` に依存します。

### 2.3. `spec-display.md`: ユーザーへの視覚的表現
- **目的:**
  - `spec-action.md`で定義されたシステムの状態やイベントを、ユーザーが直感的に理解し、快適に遊べるように、どのように視覚的に表現するかを定義します。
- **責務:**
  - ゲーム画面の基本的なレイアウト構成。
  - システムの状態（例：現在のターン、選択中のコマ）と、それに対応する視覚的表現（例：ハイライト、テキスト表示）。
  - プレイヤーの操作に対する視覚的なフィードバック（例：アニメーション）。
  - ゲームの重要なイベント（例：勝利、パス）の通知方法。
- **禁止事項:**
  - このドキュメントで、新しい機能やルールを登場させてはなりません。すべての表示は、`spec-action.md`で定義された状態やイベントに紐づく形で定義される必要があります。
- **依存関係:**
  - この文書は `spec-action.md` で定義されたシステムの状態を、どのように画面に表示するかを定義します。したがって、`spec-action.md` に依存します。

## 3. ドキュメント構造の定義
各仕様書は、以下に定義された章立て（レベル2見出し `##`）に厳密に従う必要があります。これにより、全ゲームドキュメントの一貫性を担保します。

### 3.1. `spec-rules.md` の構造
```markdown
# [ゲーム名] ルール
## 1. ゲームの目的
## 2. ゲームの準備
## 3. ゲームの進め方
## 4. ゲームの終了と勝敗

---
## 本資料で定義すべきこと
```

### 3.2. `spec-action.md` の構造
```markdown
# [ゲーム名] システム動作仕様
## 1. ゲームの状態管理
## 2. ゲームの初期化
## 3. プレイヤーの操作と状態遷移
## 4. 不正な操作への対応

---
## 本資料で定義すべきこと
```

### 3.3. `spec-display.md` の構造
```markdown
# [ゲーム名] システム表示仕様
## 1. 基本的な画面構成
## 2. ゲーム状態の視覚的表現
## 3. プレイヤー操作へのフィードバック
## 4. ゲームイベントの通知
## 5. ヒント機能の表示仕様

---
## 本資料で定義すべきこと
```

## 4. 「本資料で定義すべきこと」セクション
各仕様書の末尾には、必ず`---`（水平線）を挟んでから `## 本資料で定義すべきこと` というセクションを設けます。

このセクションは、現在の仕様書ではまだ定義が不足しているものの、本来その仕様書の責務範囲内で定義されるべき項目をメモとして残すために使用します。これにより、将来の機能追加や仕様改善の際に、考慮すべき点を明確にすることができます。