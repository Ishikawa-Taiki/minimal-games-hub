# リバーシ システム動作仕様

## 1. ゲームの状態管理
システムは、ゲームを正しく進行させるために、以下の情報を常に記憶・管理します。

- **盤面の状態:** 8x8の各マスが、「黒の石」「白の石」「空」のいずれであるか。
- **手番:** 現在、どちらのプレイヤー (`'BLACK'` または `'WHITE'`) の手番であるか。
- **石の数:** 各プレイヤーの石が、盤上にそれぞれ何個あるか。
- **ゲーム状況:** ゲームが「プレイ中」、「結果表示中」のいずれの状態にあるか。

## 2. ゲームの初期化
ゲームが開始される（またはリセットされる）際、システムは状態を以下のように設定します。

1.  **盤面の配置:** 盤面の中央4マスに、黒と白の石を2つずつ交互に配置します。他のマスはすべて「空」にします。
2.  **状態の初期化:**
    -   手番を `'BLACK'` のプレイヤーに設定します。
    -   石の数を「黒: 2個」「白: 2個」に設定します。
    -   ゲーム状況を「プレイ中」にします。

## 3. プレイヤーの操作と状態遷移
プレイヤーが盤上のマスを1つ選択した際、システムは以下の手順で処理を実行します。

1.  **操作の検証:**
    -   選択されたマスが、現在の手番のプレイヤーにとって有効な手（石を置ける場所）であるかを確認します。有効な手とは、そのマスに石を置くことで、相手の石を1つ以上挟むことができる場所を指します。
2.  **盤面の更新:**
    -   検証を通過した場合、選択されたマスに、現在の手番プレイヤーの色の石を配置します。
    -   その配置によって挟まれた、すべての方向の相手の石を、自分の色の石に裏返します。
3.  **石の数の更新:**
    -   盤面全体の石の数を再計算し、各プレイヤーの石の数を更新します。
4.  **手番の交代とパスの判定:**
    -   **相手の確認:** 次の手番となる相手プレイヤーに、石を置ける有効な手があるかを確認します。
    -   **通常交代:** 有効な手がある場合、手番を相手プレイヤーに交代します。
    -   **パス:** 有効な手がない場合、相手の手番をパスとし、再び元のプレイヤーの手番となります。
5.  **ゲーム終了判定:**
    -   手番交代後、盤面全体を確認し、ゲームの終了条件が満たされているか判定します。
    -   **終了条件:** 盤上のすべてのマスが埋まっている、または、黒白両プレイヤーともに有効な手がない場合。
    -   終了条件が満たされた場合、ゲーム状況を「結果表示中」とし、最終的な石の数に基づいて勝敗を決定します。

## 4. 不正な操作への対応
プレイヤーがルール上許可されていない操作を行った場合、システムはその操作を無視し、ゲームの状態は一切変更されません。
- **例:**
  - 石が既に置かれているマスを選択する。
  - 相手の石を挟むことができないマスを選択する。

---
## 本資料で定義すべきこと
- パスが連続して発生し、両者とも手がない状態になった際のゲーム終了ロジックは実装されているが、仕様としてさらに詳細な記述が可能です。
